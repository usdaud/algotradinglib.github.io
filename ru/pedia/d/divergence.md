# Дивергенция

Дивергенция — это фундаментальная концепция в техническом анализе, которая относится к ситуации, когда цена актива движется в направлении, противоположном индикатору. Это явление часто интерпретируется как сигнал о том, что текущий ценовой тренд может ослабевать или разворачиваться. Дивергенция может использоваться для прогнозирования потенциальных разворотов направления цены, поэтому она является важным инструментом в арсенале алгоритмических трейдеров.

## Типы дивергенции

Дивергенция бывает двух основных типов: Обычная дивергенция и Скрытая дивергенция.

### Обычная дивергенция

Обычная дивергенция — это ситуация, когда цена актива и конкретный технический индикатор, чаще всего Индекс относительной силы (RSI) или Схождение-расхождение скользящих средних (MACD), движутся в противоположных направлениях. Она может быть как бычьей, так и медвежьей.

#### Бычья обычная дивергенция

Бычья обычная дивергенция возникает, когда цена актива формирует более низкий минимум, в то время как индикатор формирует более высокий минимум. Это предполагает, что нисходящий импульс замедляется, хотя цена продолжает падать, и может указывать на предстоящий бычий разворот.

- **Пример:** Если цена Bitcoin формирует более низкий минимум, но индикатор RSI формирует более высокий минимум, это может указывать на ослабление давления продаж и возможный рост цены.

#### Медвежья обычная дивергенция

Медвежья обычная дивергенция возникает, когда цена формирует более высокий максимум, но индикатор формирует более низкий максимум. Это предполагает, что восходящий импульс ослабевает, хотя цена продолжает расти, и может указывать на предстоящий медвежий разворот.

- **Пример:** Если S&P 500 формирует более высокий максимум, но MACD формирует более низкий максимум, эта дивергенция может указывать на ослабление покупательского давления, что может привести к падению цены.

### Скрытая дивергенция

Скрытая дивергенция возникает, когда цена актива движется в том же направлении, что и тренд, но индикатор движется в противоположном направлении. Как и обычная дивергенция, она также может быть бычьей или медвежьей.

#### Бычья скрытая дивергенция

Бычья скрытая дивергенция возникает, когда цена формирует более высокий минимум, в то время как индикатор формирует более низкий минимум. Это предполагает, что восходящий тренд, вероятно, продолжится, несмотря на противоположный сигнал индикатора.

- **Пример:** В сценарии, когда цена акций Apple Inc. формирует более высокий минимум, но RSI формирует более низкий минимум, это может подтвердить продолжение восходящего тренда.

#### Медвежья скрытая дивергенция

Медвежья скрытая дивергенция возникает, когда цена формирует более низкий максимум, но индикатор формирует более высокий максимум. Это указывает на то, что нисходящий тренд, вероятно, продолжится, несмотря на противоположный сигнал индикатора.

- **Пример:** Если цена акций Tesla формирует более низкий максимум, но MACD формирует более высокий максимум, это может подтвердить продолжение нисходящего тренда.

## Индикаторы, часто используемые для определения дивергенции

Для обнаружения дивергенции можно использовать несколько технических индикаторов, и выбор индикатора часто зависит от торгуемого актива и используемой торговой стратегии. Наиболее часто используемые индикаторы включают:

### Индекс относительной силы (RSI)

RSI измеряет скорость и изменение ценовых движений и колеблется между 0 и 100. Традиционно используется для определения состояний перекупленности или перепроданности, но также может быть высокоэффективен для выявления дивергенции.

- **Бычья дивергенция:** Определяется, когда RSI формирует более высокие минимумы, в то время как цена формирует более низкие минимумы.
- **Медвежья дивергенция:** Определяется, когда RSI формирует более низкие максимумы, в то время как цена формирует более высокие максимумы.

### Схождение-расхождение скользящих средних (MACD)

MACD — это трендовый индикатор импульса, который показывает взаимосвязь между двумя скользящими средними цены ценной бумаги. Он состоит из линии MACD, сигнальной линии и гистограммы.

- **Бычья дивергенция:** Возникает, когда линия MACD формирует более высокие минимумы, в то время как цена формирует более низкие минимумы.
- **Медвежья дивергенция:** Возникает, когда линия MACD формирует более низкие максимумы, в то время как цена формирует более высокие максимумы.

### Стохастический осциллятор

Стохастический осциллятор — это индикатор импульса, который сравнивает определённую цену закрытия ценной бумаги с диапазоном её цен за определённый период времени. Он колеблется между 0 и 100.

- **Бычья дивергенция:** Определяется, когда стохастический осциллятор формирует более высокие минимумы, в то время как цена формирует более низкие минимумы.
- **Медвежья дивергенция:** Определяется, когда стохастический осциллятор формирует более низкие максимумы, в то время как цена формирует более высокие максимумы.

### Индекс товарного канала (CCI)

CCI — это осциллятор, используемый для определения циклических трендов в сырьевых товарах, но также может применяться к акциям. Он особенно хорош для определения дивергенции.

- **Бычья дивергенция:** Возникает, когда CCI формирует более высокие минимумы, в то время как цена формирует более низкие минимумы.
- **Медвежья дивергенция:** Возникает, когда CCI формирует более низкие максимумы, в то время как цена формирует более высокие максимумы.

## Реализация в алгоритмической торговле

Системы алгоритмической торговли могут быть запрограммированы для автоматического обнаружения дивергенции с использованием предопределённых критериев и исполнения сделок на основе этих сигналов. Эффективность таких алгоритмов зависит от качества данных, сложности моделей и скорости исполнения.

### Сбор данных

Для точного обнаружения дивергенции требуются высококачественные данные в реальном времени и исторические данные. Эти данные можно получить от различных поставщиков, включая:

- **Bloomberg**: bloomberg.com
- **Reuters**: reuters.com
- **Quandl**: quandl.com

### Обнаружение сигналов

После сбора данных следующий шаг включает обнаружение сигналов. Это можно сделать с использованием нескольких языков программирования и платформ, включая Python с библиотеками Pandas и NumPy, или специализированные торговые платформы, такие как MetaTrader.

- **Python**: Python можно использовать для написания скриптов, которые непрерывно отслеживают рыночные данные в реальном времени на предмет сигналов дивергенции.
- **MetaTrader**: Язык MQL5 MetaTrader позволяет создавать автоматизированных торговых роботов (Expert Advisors), которые могут обнаруживать сигналы дивергенции в реальном времени.

### Пример кода на Python

Простой пример того, как обнаружить бычью и медвежью дивергенцию с помощью Python:

```python
import pandas as pd
import numpy as np

def find_divergence(prices, indicator):
    divergences = []
    for i in range(1, len(prices)):
        if prices[i] < prices[i-1] and indicator[i] > indicator[i-1]:
            divergences.append(('Бычья дивергенция', prices.index[i]))
        elif prices[i] > prices[i-1] and indicator[i] < indicator[i-1]:
            divergences.append(('Медвежья дивергенция', prices.index[i]))
    return divergences

# Пример использования с тестовыми данными
prices = pd.Series([100, 102, 101, 105, 104])
indicator = pd.Series([70, 72, 71, 73, 71])

divergences = find_divergence(prices, indicator)
for d in divergences:
    print(d)
```

### Исполнение сделок

Последний шаг — исполнение сделок на основе обнаруженных сигналов дивергенции. Эффективность этого процесса может быть значительно повышена за счёт использования торговой инфраструктуры с низкой задержкой и прямого доступа к рынку.

- **Услуги алгоритмического исполнения**: Многие брокеры предлагают услуги алгоритмического исполнения, которые могут использоваться для обеспечения более быстрого и эффективного исполнения сделок.
- **Прямой доступ к рынку (DMA)**: Использование DMA может снизить задержку и повысить эффективность торговой стратегии.

## Заключение

Дивергенция является мощным инструментом в техническом анализе, который может предоставить ранние сигналы о потенциальных разворотах тренда. При реализации в системах алгоритмической торговли она может повысить способность принимать обоснованные и своевременные торговые решения. Использование различных технических индикаторов, сбор высококачественных данных, точное обнаружение сигналов и эффективное исполнение сделок — всё это критические компоненты использования дивергенции в алгоритмической торговле.
