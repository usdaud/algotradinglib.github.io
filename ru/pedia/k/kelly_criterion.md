# Критерий Келли

Критерий Келли - это формула, используемая для определения оптимального размера серии ставок с целью максимизации логарифма капитала, тем самым оптимизируя темп роста капитала. Он часто применяется в ситуациях, связанных с повторяющимися инвестициями или ставками, включая актуарную науку, биржевую торговлю и особенно алгоритмическую торговлю. Разработанный Джоном Л. Келли-младшим в 1956 году, критерий Келли помогает трейдерам и игрокам рассчитать наиболее подходящую долю их банкролла для риска на одной сделке или ставке, увеличивая сложный рост с течением времени при минимизации риска разорения.

## Базовая формула

Формула Келли может быть математически представлена следующим образом:

```
f* = (bp - q) / b
```

Где:
- `f*` - доля текущего банкролла для ставки.
- `b` - чистые коэффициенты выигрыша (коэффициенты представлены как "b к 1").
- `p` - вероятность выигрыша.
- `q` - вероятность проигрыша, равная `1 - p`.

### Пример расчёта

Рассмотрим акцию с 60% вероятностью (p = 0.60) роста в стоимости на одну единицу в короткие сроки и 40% вероятностью (q = 0.40) снижения на одну единицу. Чистые коэффициенты `b` составят 1:1.

Подставляя эти значения в формулу Келли, получаем:

```
f* = (1 * 0.60 - 0.40) / 1
   = 0.20
```

Этот расчёт предполагает, что инвестор должен рисковать 20% своего банкролла на эту конкретную акцию.

## Практическое применение

Критерий Келли особенно полезен для управления портфелем и алгоритмической торговли. В торговле он позволяет калибровать размеры сделок на основе преимущества (ожидания прибыли) и дисперсии (риска). Алгоритмические трейдеры полагаются на эту формулу для стабилизации и оптимизации роста своего капитала в течение длительных периодов.

### Ограничения и соображения

1. **Предположение об известных вероятностях**: Критерий Келли предполагает, что вероятности (p и q) и доходность (b) данной сделки известны, что на практике может быть трудно точно оценить.

2. **Риск чрезмерных ставок**: Хотя он максимизирует логарифмический рост капитала, критерий Келли может предлагать большие размеры ставок, которые могут быть непрактичными или психологически сложными для многих трейдеров. Обычно рекомендуется использовать долю от размера ставки Келли (половинный Келли, четвертной Келли и т.д.) для более эффективного управления волатильностью и просадками.

3. **Рыночные условия**: Эффективность критерия Келли может быть чувствительна к рыночным условиям. В волатильных или экстремальных рыночных условиях рекомендации критерия могут привести к существенной волатильности доходности.

## Келли в алгоритмической торговле

Алгоритмическая торговля включает использование программного обеспечения для автоматизации торговых решений на основе математических моделей, и критерий Келли часто включается в эти модели для обеспечения оптимального размера ставок. Различные компании и поставщики программного обеспечения используют критерий Келли для повышения торговой эффективности.

### Компании, использующие критерий Келли

- **Numerai**: Numerai - это хедж-фонд, применяющий алгоритмы машинного обучения к торговым данным. Они часто включают продвинутые методы управления рисками, включая основанные на критерии Келли.

- **Bridgewater Associates**: Bridgewater - один из крупнейших мировых хедж-фондов, известный своими систематическими и количественными подходами к торговле, которые часто включают методологии оценки риска, сходные с критерием Келли.

- **Two Sigma**: Two Sigma применяет искусственный интеллект, машинное обучение и распределённые вычисления к финансовым рынкам. Компания использует сложные стратегии управления рисками и распределения, многие из которых основаны на принципах, аналогичных критерию Келли.

## Исторический контекст и развитие

Джон Л. Келли-младший разработал критерий Келли изначально для применения в телекоммуникациях, работая в Bell Labs, но он приобрёл известность в финансовом секторе, особенно благодаря работам известных инвесторов, таких как Уоррен Баффетт и Билл Гросс. Его применение значительно расширилось в количественных финансах и алгоритмической торговле благодаря его математической строгости и полезности в управлении и оптимизации роста.

## Математический вывод

Для лучшего понимания вывода критерия Келли полезно рассмотреть цель: максимизировать ожидаемый логарифм капитала. Этот подход основан на теории полезности, направленной на оптимизацию темпа роста инвестиций, а не их абсолютной стоимости.

При текущем капитале `W` и доле `f` для ставки формула для ожидаемого логарифма будущего капитала `E[log(W)]` может быть представлена как:

```
E[log(W)] = p * log(W + f * W + b * f * W) + (1 - p) * log(W - f * W)
```

Максимизация этого ожидания относительно `f` приводит к критерию Келли, выведенному ранее. Этот вывод опирается на исчисление и принципы выпуклой оптимизации.

## Альтернативные стратегии определения размера ставок

Хотя критерий Келли оптимально эффективен с математической точки зрения, существуют и другие методы определения размера ставок, которые соответствуют различным уровням толерантности к риску и рыночным условиям:

1. **Ставки с фиксированной долей**: Распределение фиксированного процента общего капитала на сделку независимо от индивидуальных коэффициентов сделки.
2. **Система Мартингейла**: Увеличение размера ставки после проигрыша - рискованная стратегия, обычно не рекомендуемая в профессиональной торговле.
3. **Анти-Мартингейл**: Увеличение размера ставки после выигрыша, несколько похожий на подход Келли, но более простой в применении.

## Заключение

Критерий Келли представляет собой мощный инструмент для управления рисками и роста капитала в торговле. Его математическая основа обеспечивает систематическое увеличение логарифма капитала, хотя практическое применение требует тщательного рассмотрения точности прогнозов, рыночных условий и толерантности к риску. В быстро меняющемся мире алгоритмической торговли критерий Келли продолжает выделяться как ключевой подход к оптимизации размеров ставок и эффективному управлению инвестиционными рисками.
