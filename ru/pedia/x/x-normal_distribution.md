# X-Нормальное распределение

X-Нормальное распределение, часто называемое распределением Джонсона SU или просто распределением SU, является непрерывным вероятностным распределением, широко используемым в области статистики и, более конкретно, в анализе финансовых данных и алгоритмической торговле. Это распределение принадлежит к семейству распределений Джонсона, которые были введены Норманом Л. Джонсоном в 1949 году. Эти распределения особенно полезны для моделирования данных, которые не соответствуют нормальному распределению (гауссовому распределению), особенно ассиметричных и с тяжелыми хвостами наборов данных, которые распространены в финансовых доходностях.

## Математическая формулировка

X-Нормальное распределение описывается с использованием преобразования нормальной вариаты. Преобразование включает параметры, которые контролируют асимметрию и эксцесс, делая его достаточно гибким для моделирования различных форм вероятностных распределений.

X-Нормальное распределение \(Y\) может быть определено с использованием нормальной вариаты \(Z\):

\[ Y = \gamma + \delta \sinh\left(\frac{Z - \xi}{\lambda}\right) \]

где:
- \(\gamma\) и \(\delta\) - параметры формы,
- \(\xi\) - параметр местоположения,
- \(\lambda\) - параметр масштаба,
- \(Z\) - стандартная нормальная переменная.

### Функция плотности вероятности (PDF)

Функция плотности вероятности X-Нормального распределения задается как:

\[ f(y|\gamma, \delta, \xi, \lambda) = \frac{\delta}{\sqrt{2\pi}} \frac{\exp\left(-\frac{1}{2} \left(\frac{\left(\sinh^{-1}\left(\frac{y - \xi}{\delta}\right) - \gamma\right)}{\lambda}\right)^2\right)}{\sqrt{1 + \left(\frac{y - \xi}{\delta}\right)^2}} \]

где \(\sinh^{-1}\) - обратная гиперболическая синусная функция.

### Кумулятивная функция распределения (CDF)

Кумулятивная функция распределения X-Нормального распределения не может быть выражена в замкнутой форме и обычно требует численной оценки. Однако она основана на кумулятивной функции распределения нормального распределения, \(\Phi(z)\):

\[ F(y|\gamma, \delta, \xi, \lambda) = \Phi\left(\frac{\sinh^{-1}\left(\frac{y - \xi}{\delta}\right) - \gamma}{\lambda}\right) \]

### Моменты

Моменты X-Нормального распределения являются сложными функциями его параметров. Тем не менее, среднее (\(\mu\)), дисперсия (\(\sigma^2\)), асимметрия (\(\gamma_1\)) и эксцесс (\(\beta_2\)) могут быть вычислены численно.

#### Среднее

Среднее задается как:

\[ \mu = \int_{-\infty}^{\infty} y \cdot f(y|\gamma, \delta, \xi, \lambda) \, dy \]

#### Дисперсия

Дисперсия задается как:

\[ \sigma^2 = \int_{-\infty}^{\infty} (y - \mu)^2 \cdot f(y|\gamma, \delta, \xi, \lambda) \, dy \]

#### Асимметрия и эксцесс

Асимметрия и эксцесс выводятся из моментов более высокого порядка, но, как правило, более сложны для выражения в замкнутой форме. Эти моменты указывают, как распределение отклоняется от нормального распределения с точки зрения асимметрии и тяжести хвостов.

## Применения в алгоритмической торговле

Область алгоритмической торговли включает использование сложных алгоритмов и математических моделей для принятия торговых решений. X-Нормальное распределение особенно полезно в этом контексте по нескольким причинам:

### Моделирование финансовых доходностей

Финансовые доходности часто демонстрируют асимметрию и тяжелые хвосты - характеристики, которые плохо моделируются нормальным распределением. Гибкость X-Нормального распределения в учете этих особенностей делает его ценным инструментом для финансовых инженеров и квантов.

### Управление рисками

Правильное управление рисками требует точного моделирования доходностей активов для понимания вероятности экстремальных потерь. Способность X-Нормального распределения моделировать тяжелые хвосты делает его подходящим для расчетов стоимости под риском (VaR) и условной стоимости под риском (CVaR), которые критически важны в контексте управления рисками.

### Ценообразование опционов

Модели ценообразования опционов часто предполагают нормально распределенные доходности; однако реальные рыночные данные обычно демонстрируют асимметрию и эксцесс. Используя X-Нормальное распределение для моделирования распределения доходности базового актива, трейдеры могут достичь более точных цен опционов и стратегий хеджирования.

### Оптимизация портфеля

В оптимизации портфеля предположение о нормальности может привести к субоптимальным распределениям активов. X-Нормальное распределение позволяет более точно моделировать распределения доходности, что приводит к улучшенному построению портфеля и производительности.

## Реализация в R и Python

### Реализация в R

```r
# Установка пакета `sn`
install.packages("sn")

library(sn)

# Подгонка X-нормального (Джонсона SU) распределения к данным
data <- rnorm(100) # Пример данных
fit <- selm(y ~ 1, data.frame(y=data), family="SN")

# Параметры
params <- coef(fit)
gamma <- params[1]
delta <- params[2]
xi <- params[3]
lambda <- params[4]
```

### Реализация в Python

```python
import numpy as np
import scipy.stats as stats
from scipy.optimize import minimize

# Определение PDF X-нормального распределения
def x_normal_pdf(y, gamma, delta, xi, lambda_):
    sinh_part = np.sinh((y - xi) / delta)
    z = (np.arcsinh(sinh_part) - gamma) / lambda_
    pdf = (delta / np.sqrt(2 * np.pi)) * (np.exp(-0.5 * z**2) / np.sqrt(1 + sinh_part**2))
    return pdf

# Примерные данные
data = np.random.randn(100)

# Функция логарифмического правдоподобия
def log_likelihood(params):
    gamma, delta, xi, lambda_ = params
    pdf_vals = x_normal_pdf(data, gamma, delta, xi, lambda_)
    return -np.sum(np.log(pdf_vals))

# Начальные предположения параметров
initial_params = [0, 1, 0, 1]

# Подгонка модели
result = minimize(log_likelihood, initial_params, method='Nelder-Mead')

fit_params = result.x
gamma, delta, xi, lambda_ = fit_params
```

## Компании, использующие X-нормальное распределение

Несколько компаний и финансовых институтов применяют продвинутые статистические методы, такие как X-Нормальное распределение, для моделирования поведения рынка, управления рисками и алгоритмической торговли. Примечательные примеры включают:

- **QuantConnect**:
- **Kensho Technologies**:
- **Numerai**:
- **Two Sigma**:

## Заключение

X-Нормальное распределение, или распределение Джонсона SU, является мощным инструментом для моделирования ненормальных финансовых данных. Его гибкость в захвате асимметрии и тяжелых хвостов делает его особенно подходящим для различных приложений в алгоритмической торговле, управлении рисками, ценообразовании опционов и оптимизации портфеля. Его использование в современном финансовом анализе подчеркивает важность выбора соответствующих вероятностных распределений для учета поведения данных реального мира для принятия более обоснованных и эффективных финансовых решений.
