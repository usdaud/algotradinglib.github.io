# Нормальное обратное гауссово распределение

Нормальное обратное гауссово (NIG) распределение - это непрерывное вероятностное распределение, которое широко используется в области финансового моделирования и алгоритмической торговли. Это распределение принадлежит к подклассу обобщенных гиперболических распределений и особенно примечательно своей способностью захватывать асимметрию и эксцесс в данных, которые являются важными характеристиками в финансовых временных рядах.

## Математическое определение

Случайная переменная X, как говорят, следует нормальному обратному гауссову распределению, если ее функция плотности вероятности (PDF) может быть выражена как:

f(x; α, β, δ, μ) = (α δ K_1(α √(δ² + (x - μ)²))) / (π √(δ² + (x - μ)²)) exp(δ √(α² - β²) + β (x - μ))

где K_1 - модифицированная функция Бесселя второго рода с индексом 1, а параметры α, β, δ, μ должны удовлетворять условию α > |β|.

- α: Параметр формы, который определяет крутость и эксцесс распределения.
- β: Параметр асимметрии; когда β = 0, распределение симметрично.
- δ: Параметр масштаба, который влияет на разброс распределения.
- μ: Параметр местоположения, который сдвигает распределение вдоль оси x.

## Свойства

### Моменты

NIG распределение имеет хорошо определенные моменты, предоставляемые следующими уравнениями:

- **Среднее**: E[X] = μ + δ β/√(α² - β²)
- **Дисперсия**: Var(X) = δ α²/(α² - β²)^(3/2)
- **Асимметрия**: Skewness(X) = 3β / α √(δ / α (α² - β²))
- **Эксцесс**: Kurtosis(X) = 3(1 + 4β²/α²) / (δ / α (α² - β²)) + 3

### Характеристическая функция

Характеристическая функция NIG-распределенной случайной переменной задается:

φ_X(t) = exp(i μ t + δ (√(α² - β²) - √(α² - (β + it)²)))

### Связь с другими распределениями

- **Нормальное распределение**: NIG распределение становится нормальным распределением в особом случае, когда δ → ∞ и α = γ².
- **Обратное гауссово распределение**: Когда β = 0, распределение упрощается до обратного гауссова распределения.
- **Обобщенное гиперболическое распределение**: NIG распределение является особым случаем обобщенного гиперболического распределения.

## Применения в финансах

Способность NIG распределения моделировать толстые хвосты и асимметрию делает его особенно полезным в финансовых приложениях. Некоторые ключевые применения включают:

### Ценообразование активов

NIG распределение может обеспечить лучшую подгонку для доходностей финансовых активов по сравнению с нормальным распределением. Эта улучшенная подгонка помогает в создании более точных моделей ценообразования.

### Управление рисками

Поскольку финансовые доходности часто демонстрируют тяжелые хвосты и асимметрию, использование NIG распределения позволяет более точно количественно оценить стоимость под риском (VaR) и условную стоимость под риском (CVaR).

### Ценообразование опционов

Модели на основе NIG помогают в выведении решений в закрытой форме для ценообразования европейских опционов, облегчая более точное ценообразование и хеджирование опционов.

### Алгоритмическая торговля

Стратегии алгоритмической торговли часто требуют сложных моделей для прогнозирования краткосрочных движений цен. NIG распределение используется для более точного моделирования цен базовых активов, предлагая конкурентное преимущество в высокочастотной торговле.

## Оценка параметров

Оценка параметров для NIG распределения может выполняться различными методами:

### Оценка максимального правдоподобия (MLE)

MLE - это широко используемый метод для оценки параметров NIG распределения. Учитывая набор наблюдаемых точек данных x_1, x_2,..., x_n, функция логарифмического правдоподобия максимизируется для нахождения оценок параметров.

### Метод моментов

В этом подходе выборочные моменты (среднее, дисперсия, асимметрия, эксцесс) приравниваются к теоретическим моментам NIG распределения, и результирующая система уравнений решается для оценки параметров.

### Байесовский вывод

Байесовские методы включают определение априорных распределений для параметров и использование наблюдаемых данных для обновления этих априорных распределений, что приводит к апостериорным распределениям, которые отражают как априорные убеждения, так и наблюдаемые данные.

## Программное обеспечение и реализация

Несколько программных пакетов и библиотек облегчают реализацию NIG распределения в финансовых моделях:

- **R**: Пакет GeneralizedHyperbolic для R включает функциональность для NIG распределения.
- **Python**: Пакеты, такие как `scipy` и `statsmodels`, могут быть расширены для включения NIG распределения с использованием пользовательской реализации.
- **MATLAB**: Набор инструментов статистики и машинного обучения MATLAB содержит функции для работы с обобщенным гиперболическим распределением, включая NIG.

### Пример кода (Python)

```python
import numpy as np
from scipy.stats import norm, invgauss
from scipy.special import kv

def nig_pdf(x, alpha, beta, delta, mu):
    gamma = np.sqrt(alpha**2 - beta**2)
    psi = np.sqrt(delta**2 + (x - mu)**2)
    return (alpha / np.pi) * np.exp(delta * gamma + beta * (x - mu)) * kv(1, alpha * psi) / psi

# Примерные параметры
alpha = 1.2
beta = 0.7
delta = 0.5
mu = 0

# Генерация данных
x = np.linspace(-10, 10, 100)
pdf_values = nig_pdf(x, alpha, beta, delta, mu)

# Построение PDF
import matplotlib.pyplot as plt
plt.plot(x, pdf_values)
plt.title("NIG распределение")
plt.xlabel("x")
plt.ylabel("Плотность")
plt.show()
```

## Реальные примеры

### Инвестиционные банки

Инвестиционные банки, такие как Goldman Sachs и Morgan Stanley, часто используют сложные статистические модели, включающие NIG распределения, для лучшего управления рисками и торговли деривативами.

### Хедж-фонды

Хедж-фонды используют NIG модели для оптимизации портфеля и управления рисками для повышения доходности при минимизации рисков.

### Академические исследования

Многочисленные академические статьи и исследовательские статьи были опубликованы, которые используют NIG распределение для моделирования финансовых временных рядов и других экономических явлений.

## Ссылки

1. Barndorff-Nielsen, O. E. (1995). "Нормальные обратные гауссовы распределения и моделирование стохастической волатильности." Scandinavian Journal of statistics, 22(1), 1-13.
2. Prause, K. (1999). "Обобщенная гиперболическая модель: Оценка, финансовые деривативы и меры риска," PhD диссертация, Университет Фрайбурга.
3. Rydberg, T. H. (1999). "Обобщенные гиперболические диффузионные процессы с приложениями в финансах," Mathematical Finance, 9(2), 183-201.
4. McNeil, A. J., Frey, R., & Embrechts, P. (2005). "Количественное управление рисками: Концепции, техники и инструменты." Princeton University Press.

---

Для получения дополнительной информации вы можете посетить веб-сайты следующих компаний:
- Goldman Sachs
- Morgan Stanley
