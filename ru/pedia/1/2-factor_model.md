# Двухфакторная модель

Двухфакторная модель (2-Factor Model) — это финансовая модель, объясняющая доходность актива или портфеля через два отдельных фактора. Она относится к классу многофакторных моделей, предназначенных для выявления ключевых факторов, влияющих на доходности. В контексте алгоритмической торговли двухфакторная модель важна, так как помогает принимать более обоснованные решения.

### Понимание базовой концепции двухфакторной модели

Общий вид двухфакторной модели:

`Ri = αi + βi1F1 + βi2F2 + εi`

Где:
- `Ri` — доходность i-го актива.
- `αi` — свободный член, отражающий ожидаемую доходность, не объясненную двумя факторами.
- `βi1` и `βi2` — чувствительности (нагрузки) доходности актива к первому и второму факторам.
- `F1` и `F2` — два фактора.
- `εi` — ошибка модели, обычно предполагаемая нормально распределенной со средним, равным нулю.

### Выбор факторов

Выбор факторов критичен и зависит от контекста анализа и рынка. Наиболее распространенные факторы:

1. **Рыночный риск (MKT)**: обычно представлен доходностью широкого рыночного индекса, например S&P 500. Этот фактор отражает систематический риск для всех бумаг.

2. **Фирменные факторы (SMB, HML и др.)**: факторы, связанные с размером компании (Small Minus Big, SMB), отношением балансовой стоимости к рыночной (High Minus Low, HML) и другими метриками, влияющими на доходности.

### Применения в алгоритмической торговле

Алгоритмическая торговля использует компьютерные алгоритмы для управления торговыми решениями. Двухфакторная модель хорошо интегрируется в такие стратегии:

1. **Управление рисками**: два фактора дают более ясное понимание риска актива или портфеля. Алгоритмы используют это для более точных решений о покупке, продаже или удержании.

2. **Факторные стратегии**: трейдеры строят стратегии, использующие систематические закономерности факторов. Например, при сочетании рыночного риска и фактора размера алгоритмы адаптируют позиции к изменениям факторов.

3. **Атрибуция результатов**: модель позволяет распределить результаты портфеля по факторам и понять, что является источником доходности — движение рынка или специфические характеристики активов.

### Пример реализации

Рассмотрим алгоритмическую систему для торговли акциями, использующую двухфакторную модель с факторами:
1. Рыночный риск (`MKT`): измеряется через индекс S&P 500.
2. Размер (`SMB`): разница доходностей малой и большой капитализации.

Алгоритм обрабатывает эти факторы и корректирует позиции в акциях:

```python
import numpy as np
import pandas as pd
import statsmodels.api as sm

# Sample Data
market_data = pd.read_csv("market_data.csv")
factor_data = pd.read_csv("factor_data.csv")

# Calculate returns
market_data['Returns'] = market_data['Price'].pct_change()
factor_data['MKT'] = market_data['Returns']
factor_data['SMB'] = factor_data['SmallCap'] - factor_data['LargeCap']

# Regression model
def factor_model(returns, factors):
    X = sm.add_constant(factors)
    model = sm.OLS(returns, X).fit()
    return model

# Apply model
returns = market_data['Returns'][1:]  # Remove NaN from initial pct_change
factors = factor_data[['MKT', 'SMB']][1:]
model = factor_model(returns, factors)

print(model.summary())
```

### Ограничения двухфакторной модели

Несмотря на полезность, у модели есть ограничения:

1. **Простота**: использование лишь двух факторов может упустить другие значимые драйверы доходности.

2. **Статичность**: модель предполагает постоянные факторные нагрузки во времени, что не всегда соответствует реальности.

3. **Мультиколлинеарность**: если выбранные факторы сильно коррелируют, эффективность модели снижается.

### Реальный пример: трехфакторная модель Фама–Френча

Один из самых распространенных вариантов расширения двухфакторной модели — трехфакторная модель Фама–Френча, которая добавляет фактор стоимости:

`Ri = αi + βi1MKT + βi2SMB + βi3HML + εi`

Где `HML` означает High Minus Low — фактор отношения балансовой стоимости к рыночной, добавляющий дополнительную объясняющую силу.

### Заключение

Двухфакторная модель — удобный и относительно простой инструмент для анализа доходностей в алгоритмической торговле. Ее способность учитывать несколько источников риска и доходности делает ее полезной для точной настройки стратегий и управления рисками. Однако важно помнить о ее ограничениях и при необходимости дополнять модель другими факторами или альтернативными подходами.

Для дальнейшего изучения можно обратиться к материалам по алгоритмической торговле и финансовым моделям, публикуемым такими компаниями, как QuantConnect и Kensho Technologies.
