# Правило 4 недель

Правило 4 недель — торговая стратегия, часто используемая в алгоритмической торговле. Сформулированная Ричардом Дончианом, пионером в области управляемых фьючерсов, эта стратегия представляет собой простой метод выявления потенциальных пробоев рынка. Правило 4 недель часто используют трейдеры, стремящиеся извлечь выгоду из рыночного импульса, и оно отражает базовый тренд-следящий подход.

## Базовые концепции

### Торговля на пробой
Основная идея правила 4 недель — торговля на пробой. Пробой происходит, когда цена актива выходит за пределы уровня поддержки или сопротивления при повышенном объеме. Согласно стратегии, если цена бумаги достигает 4-недельного максимума, вероятно продолжение роста; если достигает 4-недельного минимума, вероятно продолжение снижения.

### Таймфрейм
Правило использует период 4 недели, то есть 20 торговых дней, для определения пробоев. Этот период достаточно длинный, чтобы отфильтровать краткосрочный шум и небольшие движения цен, но при этом захватывает среднесрочные тренды.

## Механика стратегии

### Сигнал покупки
Правило 4 недель формирует сигнал покупки, когда цена закрытия бумаги превышает максимальный максимум за предыдущие 4 недели. Для этого необходимо:
1. Определить максимальный максимум за последние 4 недели.
2. Если текущая цена закрытия выше этого максимума, открыть длинную позицию.

### Сигнал продажи
Соответственно, сигнал продажи появляется, когда цена закрытия падает ниже минимального минимума за последние 4 недели. Критерии:
1. Определить минимальный минимум за последние 4 недели.
2. Если текущая цена закрытия ниже этого минимума, открыть короткую позицию.

## Практическое применение

Хотя правило 4 недель относительно просто, его эффективность можно повысить, интегрировав его в более широкий торговый подход. Обычно это включает практики управления рисками, такие как стоп-лосс приказы и размер позиции, а также комбинирование с другими техническими индикаторами для подтверждения сигналов.

### Пример кода (Python)

Чтобы реализовать правило 4 недель в среде алгоритмической торговли на Python, можно использовать следующий код:

```python
import pandas as pd

def four_week_rule(data):
    """
    Implement the 4 Week Rule for breakout trading.
    
    Params:
    data - A pandas DataFrame containing 'Close' prices with a datetime index.
    
    Returns:
    buy_signals, sell_signals - Boolean Series indicating buy and sell signals.
    """
    # Rolling window for 4 weeks (20 trading days)
    highest_high = data['Close'].rolling(window=20).max()
    lowest_low = data['Close'].rolling(window=20).min()
    
    # Buy signal
    buy_signals = data['Close'] > highest_high.shift(1)
    
    # Sell signal
    sell_signals = data['Close'] < lowest_low.shift(1)
    
    return buy_signals, sell_signals

# Example usage
data = pd.read_csv('historical_prices.csv', index_col='Date', parse_dates=True)
buy_signals, sell_signals = four_week_rule(data)
```

### Практика индустрии и соображения

Многие профессиональные торговые фирмы и частные трейдеры используют вариации правила 4 недель. Адаптация правила к разным рыночным условиям и таймфреймам может существенно повысить его эффективность. При этом важно бэктестировать стратегию на исторических данных, чтобы понять ее характеристики и возможные просадки.

### Оценка стратегии

#### Плюсы
1. **Простота**: правило 4 недель легко понять и реализовать.
2. **Следование тренду**: эффективно захватывает среднесрочные тренды, позволяя «ехать» на значительных движениях цены.
3. **Объективность**: правила четкие, что устраняет большую часть неоднозначности, свойственной дискреционной торговле.

#### Минусы
1. **Рваные движения (whipsaws)**: стратегия может давать ложные сигналы в боковом рынке, приводя к потерям.
2. **Запаздывающий индикатор**: как и многие трендовые методы, правило 4 недель медленно реагирует на быстро меняющиеся рыночные условия.
3. **Управление рисками**: правило не включает встроенные механизмы управления рисками, поэтому трейдеры должны добавлять их самостоятельно.

## Заключение

Правило 4 недель остается популярной и эффективной тренд-следящей стратегией в алгоритмической торговле. Простота и удобство сделали его основой для многих торговых систем. Однако успех зависит от правильной реализации, включая дополнительные техники управления рисками и, возможно, сочетание с другими индикаторами для фильтрации ложных сигналов.

Для более продвинутых реализаций многие трейдеры используют платформы вроде QuantConnect или Alpaca для бэктестинга и запуска торговых алгоритмов на основе правила 4 недель и других стратегий.

Эффективное использование принципов торговли на пробой, заложенных в правиле 4 недель, может помочь трейдерам повысить доходность и извлекать выгоду из значимых рыночных трендов.
