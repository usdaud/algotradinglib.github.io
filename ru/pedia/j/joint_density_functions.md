# Совместные функции плотности

В теории вероятностей и статистике совместные функции плотности являются ключевой концепцией, особенно в области многомерных распределений. Они используются для описания вероятности того, что две или более случайные величины принимают определённые значения одновременно.

## Совместная функция плотности вероятности (PDF)

Совместная функция плотности вероятности двух непрерывных случайных величин \(X\) и \(Y\) обозначается как \(f_{X,Y}(x, y)\). Эта функция даёт вероятность того, что \(X\) попадает в бесконечно малый интервал около \(x\), а \(Y\) попадает в бесконечно малый интервал около \(y\). Математически она определяется как:

\[ P(a \leq X \leq b, c \leq Y \leq d) = \int_{a}^{b} \int_{c}^{d} f_{X,Y}(x, y) \, dy \, dx \]

Чтобы совместная функция плотности \(f_{X,Y}\) была корректной, она должна удовлетворять следующим свойствам:
1. **Неотрицательность**: \( f_{X,Y}(x, y) \geq 0 \) для всех \(x, y\).
2. **Нормировка**: Полный интеграл функции плотности по всем возможным значениям должен равняться 1:

\[ \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} f_{X,Y}(x, y) \, dy \, dx = 1 \]

## Маргинальные функции плотности

Имея совместную функцию плотности двух случайных величин, мы можем получить маргинальные плотности каждой переменной, интегрируя совместную плотность по диапазону другой переменной. Для совместной функции плотности \(f_{X,Y}(x, y)\) маргинальные плотности \(f_X(x)\) и \(f_Y(y)\) определяются как:

\[ f_X(x) = \int_{-\infty}^{\infty} f_{X,Y}(x, y) \, dy \]

\[ f_Y(y) = \int_{-\infty}^{\infty} f_{X,Y}(x, y) \, dx \]

Эти маргинальные плотности представляют вероятности \(X\) и \(Y\) независимо друг от друга.

## Условные функции плотности

Условная функция плотности даёт плотность одной переменной при условии, что другая переменная принимает определённое значение. Если мы хотим получить плотность \(X\) при условии \(Y = y\), обозначаемую как \(f_{X|Y}(x|y)\), мы используем:

\[ f_{X|Y}(x|y) = \frac{f_{X,Y}(x, y)}{f_Y(y)} \]

Аналогично, для \(Y\) при условии \(X = x\):

\[ f_{Y|X}(y|x) = \frac{f_{X,Y}(x, y)}{f_X(x)} \]

Эти условные плотности могут выявить зависимости между переменными.

## Независимость случайных величин

Две случайные величины \(X\) и \(Y\) считаются независимыми, если их совместная функция плотности может быть выражена как произведение их маргинальных плотностей:

\[ f_{X,Y}(x, y) = f_X(x) \cdot f_Y(y) \]

Независимость означает, что знание значения одной переменной не даёт никакой информации о другой.

## Математические ожидания и моменты

Математическое ожидание функции \(g(X, Y)\) относительно совместной функции плотности \(f_{X,Y}(x, y)\) определяется как:

\[ E[g(X, Y)] = \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} g(x, y) f_{X,Y}(x, y) \, dy \, dx \]

Важные моменты, такие как среднее и дисперсия, могут быть получены с использованием совместной функции плотности.

## Ковариация и корреляция

Ковариация измеряет совместную изменчивость \(X\) и \(Y\):

\[ \text{Cov}(X, Y) = E[(X - E[X])(Y - E[Y])] \]

С использованием совместной плотности она выражается как:

\[ \text{Cov}(X, Y) = \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} (x - \mu_X)(y - \mu_Y) f_{X,Y}(x, y) \, dy \, dx \]

Коэффициент корреляции является стандартизированной мерой этой ковариации:

\[ \rho_{X,Y} = \frac{\text{Cov}(X, Y)}{\sigma_X \sigma_Y} \]

где \(\sigma_X\) и \(\sigma_Y\) — стандартные отклонения \(X\) и \(Y\).

## Применение в алгоритмической торговле

В алгоритмической торговле совместные функции плотности могут использоваться различными способами, включая:

1. **Управление рисками**: Понимание совместного распределения доходностей активов имеет решающее значение для оптимизации портфеля и оценки рисков. Например, совместная функция плотности доходностей акций и рыночных индексов помогает в определении стратегий хеджирования.

2. **Ценообразование опционов**: Оценка стоимости мультиактивных опционов может основываться на совместном распределении цен базовых активов. Такие модели, как многомерная модель Блэка-Шоулза, используют совместные плотности для ценообразования корзинных опционов.

3. **Статистический арбитраж**: Совместные плотности могут использоваться для выявления и использования статистических взаимосвязей между различными активами или финансовыми инструментами.

4. **Модели машинного обучения**: В финансовом моделировании оценка совместной плотности может улучшить эффективность моделей, прогнозирующих цены активов, за счёт учёта зависимостей между переменными.

### Пример: Гауссова копула

Одним из популярных методов моделирования совместных распределений в алгоритмической торговле является гауссова копула, которая фиксирует структуру зависимости между несколькими переменными. Она особенно полезна для симуляции коррелированных доходностей активов.

Совместная функция плотности для двумерной гауссовой копулы с корреляцией \(\rho\) определяется как:

\[ f_{X,Y}(x,y) = \frac{1}{2\pi \sqrt{1-\rho^2}} \exp\left\{ -\frac{1}{2(1-\rho^2)} \left( x^2 - 2\rho xy + y^2 \right) \right\} \]

Здесь \(X\) и \(Y\) следуют стандартным нормальным распределениям, но коррелированы между собой через \(\rho\). Этот подход с использованием копулы позволяет гибко моделировать, комбинируя маргинальные распределения с различными структурами зависимости.

## Заключение

Понимание совместных функций плотности является основой для работы с многомерными данными в теории вероятностей и статистике. В контексте алгоритмической торговли эти концепции жизненно важны для моделирования доходностей активов, разработки торговых стратегий и эффективного управления рисками. Способность анализировать и понимать совместное поведение нескольких финансовых переменных даёт значительное преимущество в высококонкурентном мире алгоритмической торговли.
