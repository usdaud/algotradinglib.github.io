# Multiple Linear Regression — Множественная линейная регрессия

## Обзор

Множественная линейная регрессия (MLR) — это статистическая техника, которая использует несколько объясняющих переменных для прогнозирования результата переменной отклика. Этот метод расширяет простую линейную регрессию, которая использует только одну объясняющую переменную. Цель MLR — моделировать линейную связь между независимыми переменными и зависимой переменной путем подбора линейного уравнения к наблюдаемым данным.

## Уравнение регрессии

Общая форма уравнения множественной линейной регрессии:

\[ Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \cdots + \beta_n X_n + \epsilon \]

Где:
- \( Y \) — зависимая переменная.
- \( \beta_0 \) — перехват.
- \( \beta_1, \beta_2, \dots, \beta_n \) — коэффициенты для каждой независимой переменной \( X_1, X_2, \dots, X_n \).
- \( X_1, X_2, \dots, X_n \) — независимые переменные.
- \( \epsilon \) — ошибка.

## Предположения множественной линейной регрессии

1. **Линейность**: Существует линейная связь между зависимой и независимыми переменными.
2. **Независимость**: Наблюдения независимы друг от друга.
3. **Гомоскедастичность**: Остатки (ошибки) имеют постоянную дисперсию на каждом уровне \( X \).
4. **Отсутствие мультиколлинеарности**: Независимые переменные не сильно коррелированы друг с другом.
5. **Нормальность**: Остатки модели распределены нормально.

## Подбор модели

Для подбора модели множественной линейной регрессии используется метод обычных наименьших квадратов (OLS). OLS минимизирует сумму квадратов остатков, обеспечивая наилучшую подгоночную линию, которая прогнозирует \( Y \) из \( X_1, X_2, \dots, X_n \).

## Оценка модели

- **R-квадрат (\( R^2 \))**: Измеряет долю дисперсии зависимой переменной, которая предсказуема из независимых переменных. Значения варьируются от 0 до 1, с более высокими значениями, указывающими на лучшее соответствие модели.
- **Скорректированный R-квадрат**: Модифицированная версия \( R^2 \), которая корректируется на количество независимых переменных в модели.
- **F-статистика**: Тестирует общую значимость модели.
- **p-значения для коэффициентов**: Тестируют значимость отдельных коэффициентов регрессии.

## Применение в алгоритмической торговле

### Прогностическое моделирование

В алгоритмической торговле множественная линейная регрессия может использоваться для прогнозирования будущих цен акций, доходности или других финансовых метрик на основе нескольких предикторов, таких как исторические цены, объем торгов, экономические индикаторы или другие релевантные факторы. Указывая модель с несколькими предикторами, трейдеры могут захватить более сложные паттерны и отношения в данных.

### Примеры компаний, использующих MLR в торговле

1. **Two Sigma**: Использует продвинутые статистические модели, включая MLR, для прогнозирования рыночных трендов и информирования торговых решений.

2. **StockSharp**: Предоставляет платформу для алгоритмической торговли, где пользователи могут разрабатывать торговые стратегии с использованием множественной линейной регрессии и других продвинутых статистических моделей.

### Реализация с использованием Python и R

#### Python

```python
import pandas as pd
import statsmodels.api as sm

# Загрузка данных
data = pd.read_csv('data.csv')

# Определение независимых переменных и зависимой переменной
X = data[['X1', 'X2', 'X3']]
Y = data['Y']

# Добавление константы к модели
X = sm.add_constant(X)

# Подбор модели
model = sm.OLS(Y, X).fit()

# Отображение сводки модели
print(model.summary())
```

#### R

```r
# Загрузка данных
data <- read.csv('data.csv')

# Подбор модели
model <- lm(Y ~ X1 + X2 + X3, data=data)

# Отображение сводки модели
summary(model)
```

## Ограничения и соображения

1. **Переобучение**: Включение слишком многих переменных может привести к переобучению, где модель захватывает шум вместо фактического паттерна. Используйте техники, такие как кросс-валидация, чтобы смягчить этот риск.
2. **Мультиколлинеарность**: Высокая корреляция между независимыми переменными может исказить оценки и привести к ошибочным выводам. Коэффициент увеличения дисперсии (VIF) обычно используется для обнаружения мультиколлинеарности.
3. **Нарушение предположений**: Убедитесь, что ключевые предположения MLR выполнены. Нарушения могут привести к смещенным или неэффективным оценкам.

## Заключение

Множественная линейная регрессия — это мощный и широко используемый инструмент как в статистическом анализе, так и в алгоритмической торговле. Она позволяет трейдерам моделировать и прогнозировать финансовые метрики на основе нескольких релевантных факторов, делая её важной техникой в инструментарии квантов. Однако необходимо тщательно учитывать предположения модели, потенциальные ограничения и риск переобучения, чтобы обеспечить надежные и достоверные результаты.
