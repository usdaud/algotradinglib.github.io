# Авторегрессионная интегрированная скользящая средняя (ARIMA)

Модель Autoregressive Integrated Moving Average (ARIMA) — мощный статистический инструмент для прогнозирования временных рядов. Она предназначена для выявления и использования закономерностей в данных, что особенно полезно в алгоритмической торговле, где точные прогнозы цен могут приводить к прибыльным стратегиям. Модели ARIMA могут учитывать различные свойства рядов, включая тренды и сезонность, что делает их универсальным выбором для трейдеров и специалистов по данным.

## Компоненты ARIMA

Модели ARIMA состоят из трех основных компонентов:
1. **Авторегрессионный (AR)**: использует прошлые значения ряда для моделирования текущего значения. Число лагов задается параметром `p`.
2. **Интегрированный (I)**: отражает дифференцирование, применяемое для достижения стационарности ряда. Количество дифференцирований задается параметром `d`.
3. **Скользящее среднее (MA)**: использует прошлые ошибки прогнозирования для оценки будущих значений. Число лагов ошибок задается параметром `q`.

### Авторегрессионный компонент (AR)

Авторегрессионная часть ARIMA — это регрессия временного ряда на его собственные значения. Предполагается, что текущее значение можно объяснить линейной комбинацией предыдущих. Математически:

\[ Y_t = \phi_1 Y_{t-1} + \phi_2 Y_{t-2} +... + \phi_p Y_{t-p} + \epsilon_t \]

Где:
- \( Y_t \) — текущее значение ряда.
- \( \phi_1, \phi_2, ..., \phi_p \) — коэффициенты.
- \( \epsilon_t \) — ошибка.

### Интегрированный компонент (I)

Интегрированная часть ARIMA включает дифференцирование ряда для достижения стационарности. Стационарность означает неизменность статистических свойств (например, среднего и дисперсии) во времени. Нестационарные ряды могут иметь тренды, сезонность и другие структуры, которые нужно удалить. Процесс дифференцирования:

\[ Y'_t = Y_t - Y_{t-1} \]

Для первого порядка дифференцирования это можно записать как:

\[ Y''_t = Y'_t - Y'_{t-1} \]

Где:
- \( Y'_t \) — ряд после первого дифференцирования.
- \( Y''_t \) — ряд после второго дифференцирования.

Параметр `d` показывает, сколько раз применяется дифференцирование.

### Компонент скользящей средней (MA)

Компонент MA использует прошлые ошибки прогноза для оценки будущих значений. Он учитывает необъясненную часть ряда, добавляя ошибки прошлых периодов. Математически:

\[ Y_t = \mu + \epsilon_t + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} +... + \theta_q \epsilon_{t-q} \]

Где:
- \( \mu \) — среднее ряда.
- \( \epsilon_t, \epsilon_{t-1}, ..., \epsilon_{t-q} \) — ошибки прогноза.
- \( \theta_1, \theta_2, ..., \theta_q \) — коэффициенты.

## Идентификация модели

Прежде чем построить ARIMA-модель, важно определить параметры `p`, `d` и `q`. Процесс включает несколько шагов:

1. **Дифференцирование для стационарности**: построить график ряда и дифференцировать его, пока он не станет стационарным. Число дифференцирований определяет `d`.
2. **ACF и PACF**: анализ графиков автокорреляции (ACF) и частичной автокорреляции (PACF) для определения потенциальных значений `p` и `q`.
 - ACF показывает корреляцию между рядом и его прошлыми значениями.
 - PACF показывает частичную корреляцию после исключения влияния более ранних лагов.

### Интерпретация ACF и PACF

- **AR-модель**: если ряд — AR-процесс, PACF показывает значимый пик на лаге `p`, а остальные лаги незначимы. ACF затухает постепенно.
- **MA-модель**: если ряд — MA-процесс, ACF показывает значимый пик на лаге `q`, а остальные лаги незначимы. PACF затухает постепенно.
- **ARMA-модель**: для смешанных ARMA процессов идентификация сложнее и обычно включает сочетание значимых пиков в ACF и PACF.

## Построение ARIMA-модели

После определения `p`, `d` и `q` модель подгоняется к данным временного ряда. Это включает оценку коэффициентов и проверку модели через диагностику остатков.

### Оценка параметров

Параметры ARIMA обычно оцениваются методом максимального правдоподобия (MLE), который находит значения параметров, максимизирующие правдоподобие наблюдаемых данных.

### Диагностика модели

После подгонки важно убедиться, что остатки (разницы между наблюдаемыми и рассчитанными значениями) похожи на белый шум. Это означает, что модель захватила все закономерности.

- **Анализ остатков**: построить остатки и их ACF/PACF. Значимых корреляций быть не должно.
- **Тест Льюнга—Бокса (Ljung-Box)**: проверяет, отличаются ли группы автокорреляций остатков от нуля. Значимый результат означает, что модель не полностью описывает структуру ряда.

## Валидация и прогнозирование

Когда диагностика подтверждает хорошее качество, модель можно использовать для прогнозов. Важно оценивать качество на данных вне выборки.

### Метрики точности прогноза

Часто используемые метрики:
- **Mean Absolute Error (MAE)**: средняя абсолютная ошибка прогноза.
- **Root Mean Squared Error (RMSE)**: среднеквадратичная ошибка, сильнее штрафующая большие ошибки.
- **Mean Absolute Percentage Error (MAPE)**: точность в процентах.

### Прогнозирование

ARIMA строит прогноз, экстраполируя ряд на будущее с использованием подогнанных параметров и прошлых значений. Процесс включает:
1. Расчет прогнозных значений по уравнениям ARIMA.
2. Построение доверительных интервалов, отражающих неопределенность.

## Сезонная ARIMA (SARIMA)

Для рядов с сезонностью используется Seasonal ARIMA (SARIMA), расширяющая базовую ARIMA добавлением сезонных авторегрессионных и MA-компонентов. Модель обозначается так:

\[ SARIMA(p, d, q) \times (P, D, Q)_s \]

Где:
- \( (P, D, Q) \) — сезонные компоненты, аналогичные \( (p, d, q) \).
- \( s \) — сезонный период (например, 12 для месячных данных с годовой сезонностью).

### Сезонное дифференцирование

Сезонное дифференцирование — это вычитание значения из той же сезонной точки предыдущего периода. Например, сезонное дифференцирование первого порядка:

\[ Y'_t = Y_t - Y_{t-s} \]

Где \( s \) — сезонный период.

### Идентификация SARIMA

Идентификация SARIMA включает анализ сезонных лагов на графиках ACF и PACF и применение тех же принципов, что и для несезонных ARIMA.

## ARIMA в алгоритмической торговле

В алгоритмической торговле ARIMA-модели используются для прогнозирования цен активов, волатильности и других финансовых метрик. Точные прогнозы позволяют строить стратегии, использующие предполагаемые движения рынка.

### Практические соображения

- **Частота данных**: ARIMA применима к разным частотам данных — дневным, часовым или минутным.
- **Стационарность**: обеспечение стационарности критично для точности, часто требуются преобразования, например логарифмы или дифференцирование.
- **Выбросы и структурные разрывы**: финансовые ряды могут содержать выбросы или резкие изменения; ARIMA должна учитывать эти факторы, чтобы избежать смещенных прогнозов.

### Пример использования

Трейдер может использовать ARIMA для прогнозирования цен закрытия акции. Подогнав модель на исторических данных, он получает прогнозы и строит стратегию. Например, если прогноз показывает восходящий тренд, трейдер может открыть длинную позицию, а при нисходящем тренде — короткую.

## ПО и инструменты для ARIMA

Несколько программных инструментов и библиотек облегчают реализацию ARIMA:

### Python

- **Statsmodels**: комплексная библиотека для статистического моделирования, включая ARIMA и SARIMA.
 - Документация: Statsmodels
- **pmdarima**: расширение Statsmodels для автоматического подбора ARIMA.
 - Документация: pmdarima

### R

- **forecast**: популярный пакет для прогнозирования временных рядов, поддерживающий ARIMA и другие модели.
 - Документация: forecast

### MATLAB

- **Econometrics Toolbox**: предоставляет функции для моделирования ARIMA и байесовского анализа.
 - Документация: Econometrics Toolbox

## Заключение

Модель ARIMA — универсальный и мощный инструмент для прогнозирования временных рядов с широкими применениями в алгоритмической торговле. Захватывая закономерности в исторических данных, ARIMA помогает трейдерам принимать более обоснованные решения и повышать прибыльность. Корректная идентификация, валидация и применение модели необходимы, чтобы раскрыть ее потенциал в прогнозировании будущих движений рынка.
