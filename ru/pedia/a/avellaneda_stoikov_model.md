# Модель Авельянеды—Стойкова

Модель Авельянеды—Стойкова — это фреймворк маркет-мейкинга, который определяет оптимальные котировки bid и ask на основе риска инвентаря, волатильности и динамики прихода заявок. Он балансирует ожидаемую прибыль от спреда с риском удержания позиции.

## Основная идея

Маркет-мейкер выставляет котировки вокруг резервной цены, которая смещается в зависимости от инвентаря. При росте инвентаря котировки корректируются так, чтобы стимулировать сделки, уменьшающие риск.

## Ключевые уравнения

Типичная формулировка:
- Резервная цена: r = mid - inventory * gamma * sigma^2 * (T - t)
- Оптимальный спред: s = gamma * sigma^2 * (T - t) + (2 / gamma) * ln(1 + gamma / k)

Где:
- mid — середина цены
- inventory — текущая позиция
- gamma — риск-аверсия
- sigma — волатильность
- T - t — горизонт времени
- k — параметр прихода заявок

## Практическое применение

Модель дает структурированный способ сужать спред при низком риске и расширять его при росте риска инвентаря или волатильности. Она широко используется в исследованиях высокочастотного и электронного маркет-мейкинга.

## Предпосылки и ограничения

Модель предполагает определенный процесс прихода заявок и постоянную волатильность, что может не выполняться на реальных рынках. Также требуется надежная оценка параметров и быстрое исполнение.

## Интуиция модели

Модель балансирует ожидание захвата спреда и риск инвентаря. При росте позиции резервная цена смещается, чтобы котировки были сдвинуты в сторону, привлекающую сделки, уменьшающие позицию.

Это создает обратную связь, стабилизирующую инвентарь при сохранении ликвидности.

## Оценка параметров

Ключевые параметры включают волатильность, интенсивность прихода заявок и риск-аверсию. Волатильность оценивают по недавним доходностям, а скорости прихода заявок — по историческим котировкам и сделкам.

Оценки параметров следует регулярно обновлять, поскольку микроструктурные условия быстро меняются.

## Контроль инвентаря

Инвентарь — основной риск. Часто применяются лимиты, чтобы модель сокращала котирование или расширяла спред при приближении к порогам. Некоторые реализации также хеджируют инвентарь коррелированными инструментами.

## План реализации

Упрощенный поток: вычислить mid, оценить волатильность, вычислить резервную цену, вычислить оптимальный спред, выставить bid и ask, обновлять при каждом рыночном событии.

Задержки критичны, потому что устаревшие котировки могут быть «сняты». Быстрые обновления и логика отмены заявок — обязательны.

## Ограничения и стресс-тесты

Модель предполагает стабильные рыночные условия и определенный процесс прихода заявок. На быстрых рынках поток заявок меняется, и котировки могут быть слишком агрессивными. Стресс-тесты должны включать всплески волатильности и односторонний поток заявок.

## Пример сценария

Рассмотрим ликвидный инструмент со стабильными спредами и средней волатильностью. Реализацию на основе правил можно протестировать на многолетней выборке, а затем на вневыборочном периоде. Цель — проверить, что поведение модели Авельянеды—Стойкова устойчиво в разных режимах и что преимущество не зависит от узкого набора условий.

## Контрольный список реализации

- Подтвердить качество данных и согласованность временных меток
- Описать правила входа и выхода простым языком
- Проверить размер позиции и лимиты риска
- Отслеживать издержки исполнения и проскальзывание
- Проанализировать эффективность по режимам и инструментам

## Пример сценария

Рассмотрим ликвидный инструмент со стабильными спредами и средней волатильностью. Реализацию на основе правил можно протестировать на многолетней выборке, а затем на вневыборочном периоде. Цель — проверить, что поведение модели Авельянеды—Стойкова устойчиво в разных режимах и что преимущество не зависит от узкого набора условий.

## Контрольный список реализации

- Подтвердить качество данных и согласованность временных меток
- Описать правила входа и выхода простым языком
- Проверить размер позиции и лимиты риска
- Отслеживать издержки исполнения и проскальзывание
- Проанализировать эффективность по режимам и инструментам

## Операционные заметки

Определения и соглашения должны быть едиными для наборов данных и площадок. Небольшие различия в полях данных или границах сессий могут менять результаты, особенно для краткосрочных стратегий. Документируйте входные данные и допущения, чтобы результаты можно было воспроизвести.

Если концепция зависит от биржевых правил или поведения брокера, подтвердите эти правила для конкретной площадки. Операционные детали часто объясняют, почему сделка повела себя иначе, чем ожидалось.

## Стрессовые сценарии

Во время всплесков волатильности ликвидность может исчезать, а ценовые разрывы — появляться. В таких условиях индикаторы могут запаздывать, типы заявок — срабатывать неправильно, а спреды — резко расширяться.

Тестирование идеи на быстрых рынках, тонкой ликвидности и внезапных новостях помогает выявить скрытые риски. Если стратегия работает только в спокойных условиях, размер и тайминг должны это учитывать.

## Советы по документированию

Сохраняйте короткий чек-лист правил, параметров и точек решений. Фиксируйте, как концепция используется в живой торговле, и сравнивайте это с предположениями бэктеста. Это упрощает дальнейшую доработку и снижает дрейф исполнения.
