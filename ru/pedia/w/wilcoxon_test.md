# Тест Уилкоксона

Тест Уилкоксона — это непараметрический статистический тест, используемый для сравнения двух парных групп. В отличие от параметрических тестов, таких как t-тест, непараметрические тесты не делают никаких предположений о базовом распределении данных. Это делает тест Уилкоксона особенно полезным в ситуациях, когда данные не соответствуют предположению о нормальности или при работе с порядковыми данными или рангами. Тест назван в честь Фрэнка Уилкоксона, который разработал его в 1940-х годах.

## Типы Тестов Уилкоксона

Существует два основных типа тестов Уилкоксона:

1. **Знаковый Ранговый Тест Уилкоксона**: Используется для сравнения двух связанных выборок, сопоставленных выборок или повторных измерений на одной выборке для оценки того, различаются ли их средние ранги популяции.
2. **Тест Ранговых Сумм Уилкоксона (также известный как U-тест Манна-Уитни)**: Используется для сравнения двух независимых выборок для определения того, существует ли разница в их средних рангах популяции.

### Знаковый Ранговый Тест Уилкоксона

Знаковый ранговый тест Уилкоксона является непараметрическим аналогом парного t-теста для выборок. Он оценивает, является ли медиана разностей между парами наблюдений нулевой или нет.

#### Когда Использовать

Используйте знаковый ранговый тест Уилкоксона, когда:
- Разности между парами являются непрерывными, порядковыми или приблизительно интервальными.
- Разности между парами симметрично распределены относительно медианы.
- Размер выборки мал, и данные не соответствуют предположениям парного t-теста.

#### Предположения

1. Пары выбраны случайно и независимо.
2. Пары связаны.
3. Шкала измерения по крайней мере порядковая.

#### Процедура

1. **Вычислите Разности**: Вычислите разности между каждой парой наблюдений.
2. **Игнорируйте Нулевые Разности**: Если какие-либо разности равны нулю, они исключаются из теста.
3. **Ранжируйте Абсолютные Разности**: Ранжируйте абсолютные значения оставшихся разностей.
4. **Присвойте Знаки Рангам**: Присвойте положительный или отрицательный знак рангам на основе знака разностей.
5. **Суммируйте Ранги**: Вычислите сумму рангов для положительных разностей и сумму для отрицательных разностей.
6. **Вычислите Тестовую Статистику**: Тестовая статистика — это меньшая из абсолютных значений этих двух сумм.
7. **Определите P-Значение**: Используйте тестовую статистику, чтобы найти соответствующее p-значение, которое поможет принять или отклонить нулевую гипотезу.

### Пример Расчета

Ниже приведен пошаговый пример:

1. Предположим, у нас есть пары данных:
 - Пара 1: (5, 7)
 - Пара 2: (9, 13)
 - Пара 3: (4, 4)
 - Пара 4: (6, 8)
 - Пара 5: (6, 5)

2. Разности:
 - Пара 1: -2
 - Пара 2: -4
 - Пара 3: 0 (игнорируется)
 - Пара 4: -2
 - Пара 5: 1

3. Абсолютные Разности:
 - Пара 1: 2
 - Пара 2: 4
 - Пара 4: 2
 - Пара 5: 1

4. Ранги:
 - Ранг 1: 1
 - Ранг 2: 2.5 (для Пары 1 и Пары 4)
 - Ранг 4: 4

5. Присвойте Знаки и Суммируйте Ранги:
 - Сумма Положительных Рангов: 1 (для Пары 5)
 - Сумма Отрицательных Рангов: 2.5 + 2.5 + 4 = 9

6. Тестовая Статистика: Минимум из 1 и 9 = 1

7. Сравните с критическим значением или определите p-значение для заключения.

### Тест Ранговых Сумм Уилкоксона (U-тест Манна-Уитни)

Тест ранговых сумм Уилкоксона разработан для проверки нулевой гипотезы о том, что две популяции равны с точки зрения их центральной тенденции.

#### Когда Использовать

Используйте тест ранговых сумм Уилкоксона, когда:
- Данные из обеих выборок являются непрерывными, порядковыми или приблизительно интервальными.
- Распределения не обязательно нормальны, и размеры выборок могут быть разными.

#### Предположения

1. Выборки независимы.
2. Шкала измерения по крайней мере порядковая.

#### Процедура

1. **Объедините и Ранжируйте**: Объедините данные из обеих выборок и ранжируйте их от наименьшего к наибольшему. Присвойте ранги, со средними рангами для связей.
2. **Разделите Ранги**: Разделите ранги обратно на их соответствующие выборки.
3. **Суммируйте Ранги**: Вычислите сумму рангов для каждой выборки.
4. **Вычислите U**: Используйте суммы рангов для вычисления статистики U.
5. **Определите P-Значение**: Используйте статистику U, чтобы найти соответствующее p-значение для вывода о нулевой гипотезе.

### Пример Расчета

1. Предположим, у нас есть две выборки:
 - Выборка 1: 10, 15, 20
 - Выборка 2: 15, 20, 25, 30

2. Объедините и Ранжируйте:
 - 10 (1.0), 15 (2.5), 15 (2.5)
 - 20 (4.5), 20 (4.5), 25 (6.0), 30 (7.0)

3. Разделите Ранги:
 - Ранги Выборки 1: 1, 2.5, 4.5
 - Ранги Выборки 2: 2.5, 4.5, 6, 7

4. Суммируйте Ранги:
 - Сумма Рангов Выборки 1: 1 + 2.5 + 4.5 = 8
 - Сумма Рангов Выборки 2: 2.5 + 4.5 + 6 + 7 = 20

5. Вычислите U:
 - U1 = R1 - ((n1 * (n1 + 1)) / 2)
 - U2 = R2 - ((n2 * (n2 + 1)) / 2)
 - Затем U — это меньшее значение U1 и U2. Вычислите соответственно.

## Применение в Финансах и Трейдинге

Тесты Уилкоксона, особенно знаковый ранговый тест Уилкоксона, часто используются в финансовом и торговом контекстах для сравнения производительности различных торговых алгоритмов, финансовых моделей или инвестиционных стратегий, когда данные о производительности не соответствуют предположениям о нормальности.

### Алгоритмическая Торговля

В алгоритмической торговле тесты Уилкоксона могут использоваться для:

- Сравнения производительности двух торговых стратегий на разных активах или временных периодах.
- Оценки эффективности адаптации или новой версии торгового алгоритма.
- Статистической валидации гипотез количественной торговли без предположения о нормальности.

### Приложения Финтех

Финтех-компании применяют тесты Уилкоксона для:

- Валидации моделей: Сравнивая прогностические модели на тестовых наборах данных с ненормальными распределениями.
- A/B тестирования: Оценивая различные финансовые продукты или изменения пользовательского интерфейса, где метрики ответа могут быть не нормально распределены.
- Оценки риска: Сравнивая распределения исторической доходности для оценки моделей риска.

### Практический Пример

Например, финтех-компания, такая как Robinhood, может использовать знаковый ранговый тест Уилкоксона для оценки новой функции в своем торговом приложении, которая разработана для помощи пользователям в улучшении торговой производительности. Они могли бы сравнить метрики торговой производительности (такие как ежедневная доходность) выборки пользователей до и после введения новой функции, проверяя, оказывает ли новая функция статистически значимое влияние.

## Преимущества и Ограничения

### Преимущества

1. **Нет предположений о нормальности**: Тесты являются непараметрическими и не предполагают нормальное распределение.
2. **Устойчивы к выбросам**: Меньше подвержены влиянию выбросов по сравнению с параметрическими тестами.
3. **Малые размеры выборок**: Хорошо работают даже с малыми размерами выборок, где параметрические тесты могут потерпеть неудачу.

### Ограничения

1. **Меньшая Мощность**: Тесты Уилкоксона обычно менее мощны, чем их параметрические аналоги, если базовое распределение нормальное.
2. **Проблемы Масштабируемости**: Могут стать громоздкими с очень большими наборами данных.
3. **Интерпретация**: Результаты могут быть менее интуитивными по сравнению с параметрическими тестами.

В заключение, тест Уилкоксона — это универсальный статистический инструмент, который предоставляет надежную альтернативу параметрическим тестам, особенно при работе с ненормальными распределениями или порядковыми данными. Его приложения в финансах и торговле, особенно в алгоритмической торговле и финтехе, подчеркивают его важность в практических, реальных сценариях. Будь то сравнение торговых алгоритмов или оценка финансовых моделей, тест Уилкоксона остается ценным инструментом для аналитиков данных и финансовых аналитиков.
