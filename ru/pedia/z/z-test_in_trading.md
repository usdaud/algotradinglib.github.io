# Z-тест

## Введение

В мире финансовых рынков и алгоритмической торговли статистические тесты, включая Z-тест, играют ключевую роль в принятии решений на основе данных. Z-тест - это тип статистического теста, который определяет, есть ли значимая разница между средними двух наборов данных. В торговле он помогает проверять торговые стратегии, сравнивать доходности и оценивать работу торговых алгоритмов.

## Понимание Z-теста

Z-тест - это проверка гипотезы, используемая для определения наличия значимой разницы между средними двух совокупностей. Предполагается, что данные следуют нормальному распределению и размер выборки достаточно велик (обычно n > 30). Z-тест применяется для проверки нулевой гипотезы (H0), которая утверждает отсутствие различий между средними, против альтернативной гипотезы (H1), утверждающей наличие различий.

### Формула

Для одновыборочного Z-теста формула такова:

\[ Z = \frac{\overline{X} - \mu}{\frac{\sigma}{\sqrt{n}}} \]

- \(\overline{X}\) - среднее выборки
- \(\mu\) - среднее совокупности
- \(\sigma\) - стандартное отклонение совокупности
- \(n\) - объем выборки

### Двухвыборочный Z-тест

В торговле чаще встречается двухвыборочный Z-тест, где сравниваются два набора данных. Формула для двухвыборочного Z-теста:

\[ Z = \frac{(\overline{X}_1 - \overline{X}_2)}{\sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}} \]

- \(\overline{X}_1\), \(\overline{X}_2\) - средние двух выборок
- \(\sigma_1\), \(\sigma_2\) - стандартные отклонения совокупностей
- \(n_1\), \(n_2\) - объемы выборок

## Применения в торговле

### Проверка торговых стратегий

Одно из основных применений Z-теста - проверка торговых стратегий. Трейдеры используют исторические данные для бэктестинга стратегий. Z-тест помогает определить, отличается ли наблюдаемая результативность стратегии от случайности.

Например, если трейдер реализует новую алгоритмическую стратегию и получает выборку дневных доходностей, он может сравнить среднюю доходность этой выборки с бенчмарком (например, доходностью S&P 500) с помощью Z-теста. Это позволяет понять, действительно ли стратегия превосходит бенчмарк или результат обусловлен случайностью.

### Сравнение результатов

Z-тест также полезен для сравнения эффективности разных торговых алгоритмов. Например, если трейдер хочет сравнить доходности двух торговых ботов, можно использовать двухвыборочный Z-тест, чтобы проверить статистическую значимость разницы между их средними доходностями.

### Оценка риска

Помимо доходностей, трейдеры могут использовать Z-тест для сравнения показателей риска, таких как волатильность. Сравнивая стандартные отклонения двух стратегий, Z-тест может показать, является ли одна стратегия статистически менее волатильной, чем другая.

### Рыночный анализ

Трейдеры могут использовать Z-тест для анализа поведения рынка. Например, можно сравнить средние объемы торгов или ценовые движения до и после важного экономического события, чтобы определить, оказало ли событие статистически значимое влияние на рынок.

## Шаги выполнения Z-теста в торговле

### Шаг 1: Формулировка гипотез

- Нулевая гипотеза (H0): значимых различий между средними нет.
- Альтернативная гипотеза (H1): существуют значимые различия между средними.

### Шаг 2: Сбор данных

Соберите выборочные данные за анализируемый период. Убедитесь, что объем выборки достаточен для соблюдения предположения нормальности.

### Шаг 3: Расчет Z-статистики

Используя соответствующую формулу Z-теста, рассчитайте Z-статистику. Это требует определения средних, стандартных отклонений и объемов выборок.

### Шаг 4: Определение критического значения

На основе уровня значимости (обычно 0.05 или 0.01) определите критическое значение из Z-таблицы.

### Шаг 5: Сравнение Z-статистики и критического значения

Если рассчитанная Z-статистика превышает критическое значение по модулю, нулевая гипотеза отклоняется. В противном случае нулевая гипотеза не отклоняется.

## Пример

Рассмотрим практический пример, где трейдер хочет проверить, превосходит ли новый торговый алгоритм существующий.

### Гипотезы

- \(H_0\): средняя доходность нового алгоритма (\(\mu_1\)) равна средней доходности существующего алгоритма (\(\mu_2\)).
- \(H_1\): средняя доходность нового алгоритма (\(\mu_1\)) отличается от средней доходности существующего алгоритма (\(\mu_2\)).

### Сбор данных

Предположим, трейдер собрал такие недельные доходности:

- Новый алгоритм: [1.5%, 2.1%, -0.3%, 4.0%, 2.7%, -1.2%, 3.5%, 2.0%]
- Существующий алгоритм: [1.2%, 1.8%, 0.0%, 3.0%, 2.5%, -0.5%, 3.0%, 1.5%]

### Расчеты

Средние и стандартные отклонения:

- \(\overline{X}_1\) = 1.78%, \(\sigma_1\) = 1.82% (новый алгоритм)
- \(\overline{X}_2\) = 1.32%, \(\sigma_2\) = 1.35% (существующий алгоритм)

Используя формулу двухвыборочного Z-теста:

\[ Z = \frac{(1.78 - 1.32)}{\sqrt{\frac{1.82^2}{8} + \frac{1.35^2}{8}}} \approx 0.69 \]

### Критическое значение

Для уровня значимости 0.05 критическое значение Z составляет примерно +1.96.

### Решение

Поскольку 0.69 < 1.96, нулевая гипотеза не отклоняется. Значимой разницы в доходностях нового и существующего алгоритмов нет.

## Практические замечания

### Предпосылки

Z-тест делает несколько предположений:

- данные распределены нормально;
- объем выборки достаточно велик;
- дисперсия (стандартное отклонение) совокупности известна и желательно одинаковая.

### Альтернативы

Если данные не соответствуют предпосылкам Z-теста, можно использовать другие тесты, например t-тест (для малых выборок) или непараметрические тесты (при сомнениях в нормальности).

### ПО и инструменты

Разные программные инструменты поддерживают расчеты Z-теста, в том числе:

- **Excel**: содержит встроенные функции для проведения Z-тестов.
- **Python**: библиотеки SciPy и Statsmodels предоставляют широкий функционал для статистических тестов.
- **R**: язык R имеет множество пакетов для статистического анализа.

## Заключение

Z-тест - мощный статистический инструмент в арсенале алгоритмических трейдеров. Он помогает проверять стратегии, сравнивать результаты и принимать обоснованные решения на основе количественных данных. Понимая принципы работы Z-теста и корректно применяя его, трейдеры могут улучшить торговые системы и практики управления рисками.

Для более подробной информации можно обращаться к платформам статистического и финансового анализа, таким как QuantConnect, или образовательным ресурсам, например Khan Academy.

Используя Z-тест, трейдеры лучше понимают рыночную динамику и повышают качество торговых стратегий за счет строгого анализа данных и проверки гипотез.
